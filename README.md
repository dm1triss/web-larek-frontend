# WEB-ларек

## Общее описание

Данный проект — это учебный интернет-магазин, написанный на **TypeScript** и построенный по принципам архитектуры **MVP (Model–View–Presenter)**.  
Его цель — продемонстрировать, как можно организовать работу с данными, интерфейсом и событиями так, чтобы приложение оставалось простым, расширяемым и поддерживаемым.  

Приложение работает как классический интернет-магазин:  
- Загружает список товаров с сервера,  
- Отображает их пользователю,  
- Позволяет добавлять товары в корзину,  
- Собирает данные формы заказа,  
- Отправляет заказ на сервер.  

В основе лежит подход с разделением ответственности: каждая часть приложения отвечает за свою задачу, а общение между ними происходит через события.

---

## Пример работы приложения

1. **Загрузка товаров**  
   При старте Presenter вызывает `Api.get('/products')`, получает список товаров (`IProduct[]`) и передаёт их во View для отображения.  

2. **Добавление в корзину**  
   Пользователь кликает на кнопку "Купить". View сообщает об этом презентеру.  
   Presenter обновляет Model (список товаров в корзине), затем сообщает View перерисовать корзину.  

3. **Оформление заказа**  
   Пользователь заполняет форму (`IOrderForm`).  
   Presenter объединяет её с содержимым корзины в объект `IOrder`, считает `total` и передаёт в API.  
   Сервер возвращает `IOrderResult`, после чего View показывает сообщение об успехе.  

---

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Перед установкой и запуском проекта необходимо проверить наличие файла .env с ключем `API_ORIGIN`, который указывает на адрес сервера API.

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура проекта (MVP)


Добро пожаловать в документацию по архитектуре проекта. Этот документ создан для того, чтобы помочь разработчикам, студентам и новым участникам команды быстрее разобраться в устройстве системы, понять её логику и освоить основные подходы к работе с кодовой базой. Здесь мы постарались подробно описать каждую часть проекта и объяснить, как она связана с другими.


## Типы данных


В основе проекта лежит работа с данными. Чтобы структура приложения оставалась ясной, мы используем строго определённые типы. Они помогают не запутаться в названиях полей и обеспечивают надёжность кода.


### Категории товаров
```ts
type TCategory = 'софт-скил' | 'другое' | 'дополнительное' | 'кнопка' | 'хард-скил';
```


### Карточка товара
```ts
interface IProduct {
id: number;
title: string;
description?: string;
category: TCategory;
image: string;
price: number | null;
}
```


### Данные формы заказа
```ts
interface IOrderForm {
address?: string;
payment?: string;
phone?: string;
email?: string;
}
```


### Полный заказ
```ts
interface IOrder extends IOrderForm {
items: string[];
total: number;
}
```


### Результат успешного заказа
```ts
interface IOrderResult {
id: string;
total: number;
}
```

---

## API


API — это связующее звено между нашим приложением и сервером. Мы используем отдельный класс, чтобы сосредоточить в нём всю работу с запросами.


```ts
export class Api {
readonly baseUrl: string;
protected options: RequestInit;


constructor(baseUrl: string, options: RequestInit = {}) { ... }


get(uri: string) { ... }
post(uri: string, data: object, method: ApiPostMethods = 'POST') { ... }
}
```


**Основные методы:**
- `get(uri: string)` — позволяет получить данные с сервера
- `post(uri: string, data: object)` — позволяет отправить данные на сервер


---

## События

Для обмена данными между модулями используется EventEmitter.
Он позволяет подписываться на события, вызывать их и отвязываться от подписок.

Пример использования:

```ts
const events = new EventEmitter();

// Подписка
events.on('cart:add', (product: IProduct) => {
    console.log('Товар добавлен в корзину:', product);
});

// Вызов события
events.emit('cart:add', { id: 1, title: 'Ноутбук', category: 'хард-скил', image: '', price: 1000 });

```

## Утилиты

Для удобной работы с DOM и данными есть набор вспомогательных функций:

pascalToKebab — преобразование строки в kebab-case,

ensureElement / ensureAllElements — безопасный поиск элементов,

cloneTemplate — клонирование HTML-шаблонов,

bem — генерация CSS-классов по БЭМ,

isPlainObject, isBoolean — проверки типов,

createElement — фабрика DOM-элементов,

setElementData / getElementData — работа с dataset.

Пример использования:

```ts
const button = createElement<HTMLButtonElement>('button', {
  innerText: 'Купить',
  dataset: { id: '123' }
});
```

## Константы

API_URL — базовый адрес для работы с API,

CDN_URL — адрес для картинок и статического контента,

settings — объект для конфигурации проекта.

```ts
export const API_URL = `${process.env.API_ORIGIN}/api/weblarek`;
export const CDN_URL = `${process.env.API_ORIGIN}/content/weblarek`;

export const settings = { };
```

## Итог

Благодаря архитектуре MVP приложение разделено на три слоя:

Model — работает с данными и API,

View — отображает интерфейс,

Presenter — управляет логикой и событиями.

Такой подход делает проект легко расширяемым и поддерживаемым: можно менять внешний вид, API или добавлять новые функции, не переписывая всё приложение.

## MVP-схема
```ts
   [ Model ] <----> [ Presenter ] <----> [ View ]
       ↑                ↑                   ↑
       |                |                   |
     API,             События            DOM-дерево
   данные

```